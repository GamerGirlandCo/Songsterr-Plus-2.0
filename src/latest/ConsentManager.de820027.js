let cmpApi;import{o as e,p as t,a as s,F as n,h as i}from"./preact.3d326435.js";import{b$ as r,c0 as o,L as a,u as l,c1 as c,c2 as d}from"./index.9148933a.js";import"./audio.1ae45449.js";import"./env.1ef38fce.js";class DecodingError extends Error{constructor(e){super(e),this.name="DecodingError"}}class EncodingError extends Error{constructor(e){super(e),this.name="EncodingError"}}class GVLError extends Error{constructor(e){super(e),this.name="GVLError"}}class TCModelError extends Error{constructor(e,t,s=""){super(`invalid value ${t} passed for ${e} ${s}`),this.name="TCModelError"}}class Base64Url{static DICT="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_";static REVERSE_DICT=new Map([["A",0],["B",1],["C",2],["D",3],["E",4],["F",5],["G",6],["H",7],["I",8],["J",9],["K",10],["L",11],["M",12],["N",13],["O",14],["P",15],["Q",16],["R",17],["S",18],["T",19],["U",20],["V",21],["W",22],["X",23],["Y",24],["Z",25],["a",26],["b",27],["c",28],["d",29],["e",30],["f",31],["g",32],["h",33],["i",34],["j",35],["k",36],["l",37],["m",38],["n",39],["o",40],["p",41],["q",42],["r",43],["s",44],["t",45],["u",46],["v",47],["w",48],["x",49],["y",50],["z",51],["0",52],["1",53],["2",54],["3",55],["4",56],["5",57],["6",58],["7",59],["8",60],["9",61],["-",62],["_",63]]);static BASIS=6;static LCM=24;static encode(e){if(!/^[0-1]+$/.test(e))throw new EncodingError("Invalid bitField");let t=e.length%this.LCM;e+=t?"0".repeat(this.LCM-t):"";let s="";for(let t=0;t<e.length;t+=this.BASIS)s+=this.DICT[parseInt(e.substr(t,this.BASIS),2)];return s}static decode(e){if(!/^[A-Za-z0-9\-_]+$/.test(e))throw new DecodingError("Invalidly encoded Base64URL string");let t="";for(let s=0;s<e.length;s++){let n=this.REVERSE_DICT.get(e[s]).toString(2);t+="0".repeat(this.BASIS-n.length)+n}return t}}class Cloneable{clone(){let e=new this.constructor,t=Object.keys(this);return t.forEach(t=>{let s=this.deepClone(this[t]);void 0!==s&&(e[t]=s)}),e}deepClone(e){let t=typeof e;if("number"===t||"string"===t||"boolean"===t)return e;if(null!==e&&"object"===t){if("function"==typeof e.clone)return e.clone();if(e instanceof Date)return new Date(e.getTime());if(void 0!==e[Symbol.iterator]){let t=[];for(let s of e)t.push(this.deepClone(s));return e instanceof Array?t:new e.constructor(t)}{let t={};for(let s in e)e.hasOwnProperty(s)&&(t[s]=this.deepClone(e[s]));return t}}}}class BinarySearchTree extends Cloneable{root=null;isEmpty(){return!this.root}add(e){let t;let s={value:e,left:null,right:null};if(this.isEmpty())this.root=s;else for(t=this.root;;)if(e<t.value){if(null===t.left){t.left=s;break}t=t.left}else if(e>t.value){if(null===t.right){t.right=s;break}t=t.right}else break}get(){let e=[],t=this.root;for(;t;)if(t.left){let s=t.left;for(;s.right&&s.right!=t;)s=s.right;s.right==t?(s.right=null,e.push(t.value),t=t.right):(s.right=t,t=t.left)}else e.push(t.value),t=t.right;return e}contains(e){let t=!1,s=this.root;for(;s;){if(s.value===e){t=!0;break}e>s.value?s=s.right:e<s.value&&(s=s.left)}return t}min(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.root;for(;t;)t.left?t=t.left:(e=t.value,t=null);return e}max(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.root;for(;t;)t.right?t=t.right:(e=t.value,t=null);return e}remove(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.root,s=null,n="left";for(;t;)if(e<t.value)s=t,t=t.left,n="left";else if(e>t.value)s=t,t=t.right,n="right";else{if(t.left||t.right){if(t.left){if(t.right){let e=this.min(t.right);this.remove(e,t.right),t.value=e}else s?s[n]=t.left:this.root=t.left}else s?s[n]=t.right:this.root=t.right}else s?s[n]=null:this.root=null;t=null}}}class ConsentLanguages{static langSet=new Set(["BG","CA","CS","DA","DE","EL","EN","ES","ET","FI","FR","HR","HU","IT","JA","LT","LV","MT","NL","NO","PL","PT","RO","RU","SK","SL","SV","TR","ZH"]);has(e){return ConsentLanguages.langSet.has(e)}forEach(e){ConsentLanguages.langSet.forEach(e)}get size(){return ConsentLanguages.langSet.size}}class Fields{static cmpId="cmpId";static cmpVersion="cmpVersion";static consentLanguage="consentLanguage";static consentScreen="consentScreen";static created="created";static supportOOB="supportOOB";static isServiceSpecific="isServiceSpecific";static lastUpdated="lastUpdated";static numCustomPurposes="numCustomPurposes";static policyVersion="policyVersion";static publisherCountryCode="publisherCountryCode";static publisherCustomConsents="publisherCustomConsents";static publisherCustomLegitimateInterests="publisherCustomLegitimateInterests";static publisherLegitimateInterests="publisherLegitimateInterests";static publisherConsents="publisherConsents";static publisherRestrictions="publisherRestrictions";static purposeConsents="purposeConsents";static purposeLegitimateInterests="purposeLegitimateInterests";static purposeOneTreatment="purposeOneTreatment";static specialFeatureOptins="specialFeatureOptins";static useNonStandardStacks="useNonStandardStacks";static vendorConsents="vendorConsents";static vendorLegitimateInterests="vendorLegitimateInterests";static vendorListVersion="vendorListVersion";static vendorsAllowed="vendorsAllowed";static vendorsDisclosed="vendorsDisclosed";static version="version"}!function(e){e[e.NOT_ALLOWED=0]="NOT_ALLOWED",e[e.REQUIRE_CONSENT=1]="REQUIRE_CONSENT",e[e.REQUIRE_LI=2]="REQUIRE_LI"}(RestrictionType||(RestrictionType={}));class PurposeRestriction extends Cloneable{static hashSeparator="-";purposeId_;restrictionType;constructor(e,t){super(),void 0!==e&&(this.purposeId=e),void 0!==t&&(this.restrictionType=t)}static unHash(e){let t=e.split(this.hashSeparator),s=new PurposeRestriction;if(2!==t.length)throw new TCModelError("hash",e);return s.purposeId=parseInt(t[0],10),s.restrictionType=parseInt(t[1],10),s}get hash(){if(!this.isValid())throw Error("cannot hash invalid PurposeRestriction");return`${this.purposeId}${PurposeRestriction.hashSeparator}${this.restrictionType}`}get purposeId(){return this.purposeId_}set purposeId(e){this.purposeId_=e}isValid(){return Number.isInteger(this.purposeId)&&this.purposeId>0&&(this.restrictionType===RestrictionType.NOT_ALLOWED||this.restrictionType===RestrictionType.REQUIRE_CONSENT||this.restrictionType===RestrictionType.REQUIRE_LI)}isSameAs(e){return this.purposeId===e.purposeId&&this.restrictionType===e.restrictionType}}class PurposeRestrictionVector extends Cloneable{bitLength=0;map=new Map;gvl_;has(e){return this.map.has(e)}isOkToHave(e,t,s){let n=!0;if(this.gvl?.vendors){let i=this.gvl.vendors[s];if(i){if(e===RestrictionType.NOT_ALLOWED)n=i.legIntPurposes.includes(t)||i.purposes.includes(t);else if(i.flexiblePurposes.length)switch(e){case RestrictionType.REQUIRE_CONSENT:n=i.flexiblePurposes.includes(t)&&i.legIntPurposes.includes(t);break;case RestrictionType.REQUIRE_LI:n=i.flexiblePurposes.includes(t)&&i.purposes.includes(t)}else n=!1}else n=!1}return n}add(e,t){if(this.isOkToHave(t.restrictionType,t.purposeId,e)){let s=t.hash;this.has(s)||(this.map.set(s,new BinarySearchTree),this.bitLength=0),this.map.get(s).add(e)}}restrictPurposeToLegalBasis(e){let t=this.gvl.vendorIds,s=e.hash,n=function(){let e;for(e of t);return e}();for(let e=1;e<=n;e++)this.has(s)||(this.map.set(s,new BinarySearchTree),this.bitLength=0),this.map.get(s).add(e)}getVendors(e){let t=[];if(e){let s=e.hash;this.has(s)&&(t=this.map.get(s).get())}else{let e=new Set;this.map.forEach(t=>{t.get().forEach(t=>{e.add(t)})}),t=Array.from(e)}return t}getRestrictionType(e,t){let s;return this.getRestrictions(e).forEach(e=>{e.purposeId===t&&(void 0===s||s>e.restrictionType)&&(s=e.restrictionType)}),s}vendorHasRestriction(e,t){let s=!1,n=this.getRestrictions(e);for(let e=0;e<n.length&&!s;e++)s=t.isSameAs(n[e]);return s}getMaxVendorId(){let e=0;return this.map.forEach(t=>{e=Math.max(t.max(),e)}),e}getRestrictions(e){let t=[];return this.map.forEach((s,n)=>{e?s.contains(e)&&t.push(PurposeRestriction.unHash(n)):t.push(PurposeRestriction.unHash(n))}),t}getPurposes(){let e=new Set;return this.map.forEach((t,s)=>{e.add(PurposeRestriction.unHash(s).purposeId)}),Array.from(e)}remove(e,t){let s=t.hash,n=this.map.get(s);n&&(n.remove(e),n.isEmpty()&&(this.map.delete(s),this.bitLength=0))}set gvl(e){this.gvl_||(this.gvl_=e,this.map.forEach((e,t)=>{let s=PurposeRestriction.unHash(t),n=e.get();n.forEach(t=>{this.isOkToHave(s.restrictionType,s.purposeId,t)||e.remove(t)})}))}get gvl(){return this.gvl_}isEmpty(){return 0===this.map.size}get numRestrictions(){return this.map.size}}!function(e){e.COOKIE="cookie",e.WEB="web",e.APP="app"}(DeviceDisclosureStorageAccessType||(DeviceDisclosureStorageAccessType={})),function(e){e.CORE="core",e.VENDORS_DISCLOSED="vendorsDisclosed",e.VENDORS_ALLOWED="vendorsAllowed",e.PUBLISHER_TC="publisherTC"}(Segment||(Segment={}));class SegmentIDs{static ID_TO_KEY=[Segment.CORE,Segment.VENDORS_DISCLOSED,Segment.VENDORS_ALLOWED,Segment.PUBLISHER_TC];static KEY_TO_ID={[Segment.CORE]:0,[Segment.VENDORS_DISCLOSED]:1,[Segment.VENDORS_ALLOWED]:2,[Segment.PUBLISHER_TC]:3}}class Vector extends Cloneable{bitLength=0;maxId_=0;set_=new Set;*[Symbol.iterator](){for(let e=1;e<=this.maxId;e++)yield[e,this.has(e)]}values(){return this.set_.values()}get maxId(){return this.maxId_}has(e){return this.set_.has(e)}unset(e){Array.isArray(e)?e.forEach(e=>this.unset(e)):"object"==typeof e?this.unset(Object.keys(e).map(e=>Number(e))):(this.set_.delete(Number(e)),this.bitLength=0,e===this.maxId&&(this.maxId_=0,this.set_.forEach(e=>{this.maxId_=Math.max(this.maxId,e)})))}isIntMap(e){return"object"==typeof e&&Object.keys(e).every(t=>{let s=Number.isInteger(parseInt(t,10));return(s=s&&this.isValidNumber(e[t].id))&&void 0!==e[t].name})}isValidNumber(e){return parseInt(e,10)>0}isSet(e){let t=!1;return e instanceof Set&&(t=Array.from(e).every(this.isValidNumber)),t}set(e){if(Array.isArray(e))e.forEach(e=>this.set(e));else if(this.isSet(e))this.set(Array.from(e));else if(this.isIntMap(e))this.set(Object.keys(e).map(e=>Number(e)));else if(this.isValidNumber(e))this.set_.add(e),this.maxId_=Math.max(this.maxId,e),this.bitLength=0;else throw new TCModelError("set()",e,"must be positive integer array, positive integer, Set<number>, or IntMap")}empty(){this.set_=new Set}forEach(e){for(let t=1;t<=this.maxId;t++)e(this.has(t),t)}get size(){return this.set_.size}setAll(e){this.set(e)}}class BitLength{static [Fields.cmpId]=12;static [Fields.cmpVersion]=12;static [Fields.consentLanguage]=12;static [Fields.consentScreen]=6;static [Fields.created]=36;static [Fields.isServiceSpecific]=1;static [Fields.lastUpdated]=36;static [Fields.policyVersion]=6;static [Fields.publisherCountryCode]=12;static [Fields.publisherLegitimateInterests]=24;static [Fields.publisherConsents]=24;static [Fields.purposeConsents]=24;static [Fields.purposeLegitimateInterests]=24;static [Fields.purposeOneTreatment]=1;static [Fields.specialFeatureOptins]=12;static [Fields.useNonStandardStacks]=1;static [Fields.vendorListVersion]=12;static [Fields.version]=6;static anyBoolean=1;static encodingType=1;static maxId=16;static numCustomPurposes=6;static numEntries=12;static numRestrictions=12;static purposeId=6;static restrictionType=2;static segmentType=3;static singleOrRange=1;static vendorId=16}class BooleanEncoder{static encode(e){return String(Number(e))}static decode(e){return"1"===e}}class IntEncoder{static encode(e,t){let s;if("string"==typeof e&&(e=parseInt(e,10)),(s=e.toString(2)).length>t||e<0)throw new EncodingError(`${e} too large to encode into ${t}`);return s.length<t&&(s="0".repeat(t-s.length)+s),s}static decode(e,t){if(t!==e.length)throw new DecodingError("invalid bit length");return parseInt(e,2)}}class DateEncoder{static encode(e,t){return IntEncoder.encode(Math.round(e.getTime()/100),t)}static decode(e,t){if(t!==e.length)throw new DecodingError("invalid bit length");let s=new Date;return s.setTime(100*IntEncoder.decode(e,t)),s}}class FixedVectorEncoder{static encode(e,t){let s="";for(let n=1;n<=t;n++)s+=BooleanEncoder.encode(e.has(n));return s}static decode(e,t){if(e.length!==t)throw new DecodingError("bitfield encoding length mismatch");let s=new Vector;for(let n=1;n<=t;n++)BooleanEncoder.decode(e[n-1])&&s.set(n);return s.bitLength=e.length,s}}class LangEncoder{static encode(e,t){e=e.toUpperCase();let s=e.charCodeAt(0)-65,n=e.charCodeAt(1)-65;if(s<0||s>25||n<0||n>25)throw new EncodingError(`invalid language code: ${e}`);if(t%2==1)throw new EncodingError(`numBits must be even, ${t} is not valid`);t/=2;let i=IntEncoder.encode(s,t),r=IntEncoder.encode(n,t);return i+r}static decode(e,t){let s;if(t!==e.length||e.length%2)throw new DecodingError("invalid bit length for language");{let t=e.length/2,n=IntEncoder.decode(e.slice(0,t),t)+65,i=IntEncoder.decode(e.slice(t),t)+65;s=String.fromCharCode(n)+String.fromCharCode(i)}return s}}class PurposeRestrictionVectorEncoder{static encode(e){let t=IntEncoder.encode(e.numRestrictions,BitLength.numRestrictions);return e.isEmpty()||e.getRestrictions().forEach(s=>{t+=IntEncoder.encode(s.purposeId,BitLength.purposeId)+IntEncoder.encode(s.restrictionType,BitLength.restrictionType);let n=e.getVendors(s),i=n.length,r=0,o=0,a="";for(let t=0;t<i;t++){let s=n[t];0===o&&(r++,o=s);let l=n[i-1],c=e.gvl.vendorIds,d=e=>{for(;++e<=l&&!c.has(e););return e};if(t===i-1||n[t+1]>d(s)){let e=s!==o;a+=BooleanEncoder.encode(e)+IntEncoder.encode(o,BitLength.vendorId),e&&(a+=IntEncoder.encode(s,BitLength.vendorId)),o=0}}t+=IntEncoder.encode(r,BitLength.numEntries)+a}),t}static decode(e){let t=0,s=new PurposeRestrictionVector,n=IntEncoder.decode(e.substr(t,BitLength.numRestrictions),BitLength.numRestrictions);t+=BitLength.numRestrictions;for(let i=0;i<n;i++){let n=IntEncoder.decode(e.substr(t,BitLength.purposeId),BitLength.purposeId);t+=BitLength.purposeId;let i=IntEncoder.decode(e.substr(t,BitLength.restrictionType),BitLength.restrictionType);t+=BitLength.restrictionType;let r=new PurposeRestriction(n,i),o=IntEncoder.decode(e.substr(t,BitLength.numEntries),BitLength.numEntries);t+=BitLength.numEntries;for(let n=0;n<o;n++){let n=BooleanEncoder.decode(e.substr(t,BitLength.anyBoolean));t+=BitLength.anyBoolean;let i=IntEncoder.decode(e.substr(t,BitLength.vendorId),BitLength.vendorId);if(t+=BitLength.vendorId,n){let n=IntEncoder.decode(e.substr(t,BitLength.vendorId),BitLength.vendorId);if(t+=BitLength.vendorId,n<i)throw new DecodingError(`Invalid RangeEntry: endVendorId ${n} is less than ${i}`);for(let e=i;e<=n;e++)s.add(e,r)}else s.add(i,r)}}return s.bitLength=t,s}}!function(e){e[e.FIELD=0]="FIELD",e[e.RANGE=1]="RANGE"}(VectorEncodingType||(VectorEncodingType={}));class VendorVectorEncoder{static encode(e){let t;let s=[],n=[],i=IntEncoder.encode(e.maxId,BitLength.maxId),r="",o=BitLength.maxId+BitLength.encodingType,a=o+e.maxId,l=2*BitLength.vendorId+BitLength.singleOrRange+BitLength.numEntries,c=o+BitLength.numEntries;return e.forEach((i,o)=>{if(r+=BooleanEncoder.encode(i),(t=e.maxId>l&&c<a)&&i){let t=e.has(o+1);t?0===n.length&&(n.push(o),c+=BitLength.singleOrRange+BitLength.vendorId):(n.push(o),c+=BitLength.vendorId,s.push(n),n=[])}}),t?i+=String(VectorEncodingType.RANGE)+this.buildRangeEncoding(s):i+=String(VectorEncodingType.FIELD)+r,i}static decode(e,t){let s;let n=0,i=IntEncoder.decode(e.substr(n,BitLength.maxId),BitLength.maxId);n+=BitLength.maxId;let r=IntEncoder.decode(e.charAt(n),BitLength.encodingType);if(n+=BitLength.encodingType,r===VectorEncodingType.RANGE){if(s=new Vector,1===t){if("1"===e.substr(n,1))throw new DecodingError("Unable to decode default consent=1");n++}let i=IntEncoder.decode(e.substr(n,BitLength.numEntries),BitLength.numEntries);n+=BitLength.numEntries;for(let t=0;t<i;t++){let t=BooleanEncoder.decode(e.charAt(n));n+=BitLength.singleOrRange;let i=IntEncoder.decode(e.substr(n,BitLength.vendorId),BitLength.vendorId);if(n+=BitLength.vendorId,t){let t=IntEncoder.decode(e.substr(n,BitLength.vendorId),BitLength.vendorId);n+=BitLength.vendorId;for(let e=i;e<=t;e++)s.set(e)}else s.set(i)}}else{let t=e.substr(n,i);n+=i,s=FixedVectorEncoder.decode(t,i)}return s.bitLength=n,s}static buildRangeEncoding(e){let t=e.length,s=IntEncoder.encode(t,BitLength.numEntries);return e.forEach(e=>{let t=1===e.length;s+=BooleanEncoder.encode(!t)+IntEncoder.encode(e[0],BitLength.vendorId),t||(s+=IntEncoder.encode(e[1],BitLength.vendorId))}),s}}function FieldEncoderMap(){return{[Fields.version]:IntEncoder,[Fields.created]:DateEncoder,[Fields.lastUpdated]:DateEncoder,[Fields.cmpId]:IntEncoder,[Fields.cmpVersion]:IntEncoder,[Fields.consentScreen]:IntEncoder,[Fields.consentLanguage]:LangEncoder,[Fields.vendorListVersion]:IntEncoder,[Fields.policyVersion]:IntEncoder,[Fields.isServiceSpecific]:BooleanEncoder,[Fields.useNonStandardStacks]:BooleanEncoder,[Fields.specialFeatureOptins]:FixedVectorEncoder,[Fields.purposeConsents]:FixedVectorEncoder,[Fields.purposeLegitimateInterests]:FixedVectorEncoder,[Fields.purposeOneTreatment]:BooleanEncoder,[Fields.publisherCountryCode]:LangEncoder,[Fields.vendorConsents]:VendorVectorEncoder,[Fields.vendorLegitimateInterests]:VendorVectorEncoder,[Fields.publisherRestrictions]:PurposeRestrictionVectorEncoder,segmentType:IntEncoder,[Fields.vendorsDisclosed]:VendorVectorEncoder,[Fields.vendorsAllowed]:VendorVectorEncoder,[Fields.publisherConsents]:FixedVectorEncoder,[Fields.publisherLegitimateInterests]:FixedVectorEncoder,[Fields.numCustomPurposes]:IntEncoder,[Fields.publisherCustomConsents]:FixedVectorEncoder,[Fields.publisherCustomLegitimateInterests]:FixedVectorEncoder}}class FieldSequence{1={[Segment.CORE]:[Fields.version,Fields.created,Fields.lastUpdated,Fields.cmpId,Fields.cmpVersion,Fields.consentScreen,Fields.consentLanguage,Fields.vendorListVersion,Fields.purposeConsents,Fields.vendorConsents]};2={[Segment.CORE]:[Fields.version,Fields.created,Fields.lastUpdated,Fields.cmpId,Fields.cmpVersion,Fields.consentScreen,Fields.consentLanguage,Fields.vendorListVersion,Fields.policyVersion,Fields.isServiceSpecific,Fields.useNonStandardStacks,Fields.specialFeatureOptins,Fields.purposeConsents,Fields.purposeLegitimateInterests,Fields.purposeOneTreatment,Fields.publisherCountryCode,Fields.vendorConsents,Fields.vendorLegitimateInterests,Fields.publisherRestrictions],[Segment.PUBLISHER_TC]:[Fields.publisherConsents,Fields.publisherLegitimateInterests,Fields.numCustomPurposes,Fields.publisherCustomConsents,Fields.publisherCustomLegitimateInterests],[Segment.VENDORS_ALLOWED]:[Fields.vendorsAllowed],[Segment.VENDORS_DISCLOSED]:[Fields.vendorsDisclosed]}}class SegmentSequence{1=[Segment.CORE];2=[Segment.CORE];constructor(e,t){if(2===e.version){if(e.isServiceSpecific)this["2"].push(Segment.PUBLISHER_TC);else{let s=!!(t&&t.isForVendors);s&&!0!==e[Fields.supportOOB]||this["2"].push(Segment.VENDORS_DISCLOSED),s&&(e[Fields.supportOOB]&&e[Fields.vendorsAllowed].size>0&&this["2"].push(Segment.VENDORS_ALLOWED),this["2"].push(Segment.PUBLISHER_TC))}}}}class SegmentEncoder{static fieldSequence=new FieldSequence;static encode(e,t){let s;try{s=this.fieldSequence[String(e.version)][t]}catch(s){throw new EncodingError(`Unable to encode version: ${e.version}, segment: ${t}`)}let n="";t!==Segment.CORE&&(n=IntEncoder.encode(SegmentIDs.KEY_TO_ID[t],BitLength.segmentType));let i=FieldEncoderMap();return s.forEach(s=>{let r=e[s],o=i[s],a=BitLength[s];void 0===a&&this.isPublisherCustom(s)&&(a=Number(e[Fields.numCustomPurposes]));try{n+=o.encode(r,a)}catch(e){throw new EncodingError(`Error encoding ${t}->${s}: ${e.message}`)}}),Base64Url.encode(n)}static decode(e,t,s){let n=Base64Url.decode(e),i=0;s===Segment.CORE&&(t.version=IntEncoder.decode(n.substr(i,BitLength[Fields.version]),BitLength[Fields.version])),s!==Segment.CORE&&(i+=BitLength.segmentType);let r=this.fieldSequence[String(t.version)][s],o=FieldEncoderMap();return r.forEach(e=>{let s=o[e],r=BitLength[e];if(void 0===r&&this.isPublisherCustom(e)&&(r=Number(t[Fields.numCustomPurposes])),0!==r){let o=n.substr(i,r);if(s===VendorVectorEncoder?t[e]=s.decode(o,t.version):t[e]=s.decode(o,r),Number.isInteger(r))i+=r;else if(Number.isInteger(t[e].bitLength))i+=t[e].bitLength;else throw new DecodingError(e)}}),t}static isPublisherCustom(e){return 0===e.indexOf("publisherCustom")}}class SemanticPreEncoder{static processor=[e=>e,(e,t)=>{e.publisherRestrictions.gvl=t,e.purposeLegitimateInterests.unset(1);let s=new Map;return s.set("legIntPurposes",e.vendorLegitimateInterests),s.set("purposes",e.vendorConsents),s.forEach((s,n)=>{s.forEach((i,r)=>{if(i){let i=t.vendors[r];if(!i||i.deletedDate)s.unset(r);else if(0===i[n].length){if("legIntPurposes"===n&&0===i.purposes.length&&0===i.legIntPurposes.length&&i.specialPurposes.length>0);else if(e.isServiceSpecific){if(0===i.flexiblePurposes.length)s.unset(r);else{let t=e.publisherRestrictions.getRestrictions(r),i=!1;for(let e=0,s=t.length;e<s&&!i;e++)i=t[e].restrictionType===RestrictionType.REQUIRE_CONSENT&&"purposes"===n||t[e].restrictionType===RestrictionType.REQUIRE_LI&&"legIntPurposes"===n;i||s.unset(r)}}else s.unset(r)}}})}),e.vendorsDisclosed.set(t.vendors),e}];static process(e,t){let s=e.gvl;if(!s)throw new EncodingError("Unable to encode TCModel without a GVL");if(!s.isReady)throw new EncodingError("Unable to encode TCModel tcModel.gvl.readyPromise is not resolved");(e=e.clone()).consentLanguage=s.language.toUpperCase(),t?.version>0&&t?.version<=this.processor.length?e.version=t.version:e.version=this.processor.length;let n=e.version-1;if(!this.processor[n])throw new EncodingError(`Invalid version: ${e.version}`);return this.processor[n](e,s)}}class Json{static absCall(e,t,s,n){return new Promise((i,r)=>{let o=new XMLHttpRequest,a=()=>{if(o.readyState==XMLHttpRequest.DONE){if(o.status>=200&&o.status<300){let e=o.response;if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}i(e)}else r(Error(`HTTP Status: ${o.status} response type: ${o.responseType}`))}},l=()=>{r(Error("error"))},c=()=>{r(Error("aborted"))},d=()=>{r(Error("Timeout "+n+"ms "+e))};o.withCredentials=s,o.addEventListener("load",a),o.addEventListener("error",l),o.addEventListener("abort",c),null===t?o.open("GET",e,!0):o.open("POST",e,!0),o.responseType="json",o.timeout=n,o.ontimeout=d,o.send(t)})}static post(e,t){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return this.absCall(e,JSON.stringify(t),s,n)}static fetch(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.absCall(e,null,t,s)}}class GVL extends Cloneable{static LANGUAGE_CACHE=new Map;static CACHE=new Map;static LATEST_CACHE_KEY=0;static DEFAULT_LANGUAGE="EN";static consentLanguages=new ConsentLanguages;static baseUrl_;static set baseUrl(e){if(/^https?:\/\/vendorlist\.consensu\.org\//.test(e))throw new GVLError("Invalid baseUrl!  You may not pull directly from vendorlist.consensu.org and must provide your own cache");e.length>0&&"/"!==e[e.length-1]&&(e+="/"),this.baseUrl_=e}static get baseUrl(){return this.baseUrl_}static latestFilename="vendor-list.json";static versionedFilename="archives/vendor-list-v[VERSION].json";static languageFilename="purposes-[LANG].json";readyPromise;gvlSpecificationVersion;vendorListVersion;tcfPolicyVersion;lastUpdated;purposes;specialPurposes;features;specialFeatures;isReady_=!1;vendors_;vendorIds;fullVendorList;byPurposeVendorMap;bySpecialPurposeVendorMap;byFeatureVendorMap;bySpecialFeatureVendorMap;stacks;lang_;isLatest=!1;constructor(e){super();let t=GVL.baseUrl;if(this.lang_=GVL.DEFAULT_LANGUAGE,this.isVendorList(e))this.populate(e),this.readyPromise=Promise.resolve();else{if(!t)throw new GVLError("must specify GVL.baseUrl before loading GVL json");e>0?GVL.CACHE.has(e)?(this.populate(GVL.CACHE.get(e)),this.readyPromise=Promise.resolve()):(t+=GVL.versionedFilename.replace("[VERSION]",String(e)),this.readyPromise=this.fetchJson(t)):GVL.CACHE.has(GVL.LATEST_CACHE_KEY)?(this.populate(GVL.CACHE.get(GVL.LATEST_CACHE_KEY)),this.readyPromise=Promise.resolve()):(this.isLatest=!0,this.readyPromise=this.fetchJson(t+GVL.latestFilename))}}static emptyLanguageCache(e){let t=!1;return void 0===e&&GVL.LANGUAGE_CACHE.size>0?(GVL.LANGUAGE_CACHE=new Map,t=!0):"string"==typeof e&&this.consentLanguages.has(e.toUpperCase())&&(GVL.LANGUAGE_CACHE.delete(e.toUpperCase()),t=!0),t}static emptyCache(e){let t=!1;return Number.isInteger(e)&&e>=0?(GVL.CACHE.delete(e),t=!0):void 0===e&&(GVL.CACHE=new Map,t=!0),t}cacheLanguage(){GVL.LANGUAGE_CACHE.has(this.lang_)||GVL.LANGUAGE_CACHE.set(this.lang_,{purposes:this.purposes,specialPurposes:this.specialPurposes,features:this.features,specialFeatures:this.specialFeatures,stacks:this.stacks})}async fetchJson(e){try{this.populate(await Json.fetch(e))}catch(e){throw new GVLError(e.message)}}getJson(){return JSON.parse(JSON.stringify({gvlSpecificationVersion:this.gvlSpecificationVersion,vendorListVersion:this.vendorListVersion,tcfPolicyVersion:this.tcfPolicyVersion,lastUpdated:this.lastUpdated,purposes:this.purposes,specialPurposes:this.specialPurposes,features:this.features,specialFeatures:this.specialFeatures,stacks:this.stacks,vendors:this.fullVendorList}))}async changeLanguage(e){let t=e.toUpperCase();if(GVL.consentLanguages.has(t)){if(t!==this.lang_){if(this.lang_=t,GVL.LANGUAGE_CACHE.has(t)){let e=GVL.LANGUAGE_CACHE.get(t);for(let t in e)e.hasOwnProperty(t)&&(this[t]=e[t])}else{let t=GVL.baseUrl+GVL.languageFilename.replace("[LANG]",e);try{await this.fetchJson(t),this.cacheLanguage()}catch(e){throw new GVLError("unable to load language: "+e.message)}}}}else throw new GVLError(`unsupported language ${e}`)}get language(){return this.lang_}isVendorList(e){return void 0!==e&&void 0!==e.vendors}populate(e){this.purposes=e.purposes,this.specialPurposes=e.specialPurposes,this.features=e.features,this.specialFeatures=e.specialFeatures,this.stacks=e.stacks,this.isVendorList(e)&&(this.gvlSpecificationVersion=e.gvlSpecificationVersion,this.tcfPolicyVersion=e.tcfPolicyVersion,this.vendorListVersion=e.vendorListVersion,this.lastUpdated=e.lastUpdated,"string"==typeof this.lastUpdated&&(this.lastUpdated=new Date(this.lastUpdated)),this.vendors_=e.vendors,this.fullVendorList=e.vendors,this.mapVendors(),this.isReady_=!0,this.isLatest&&GVL.CACHE.set(GVL.LATEST_CACHE_KEY,this.getJson()),GVL.CACHE.has(this.vendorListVersion)||GVL.CACHE.set(this.vendorListVersion,this.getJson())),this.cacheLanguage()}mapVendors(e){this.byPurposeVendorMap={},this.bySpecialPurposeVendorMap={},this.byFeatureVendorMap={},this.bySpecialFeatureVendorMap={},Object.keys(this.purposes).forEach(e=>{this.byPurposeVendorMap[e]={legInt:new Set,consent:new Set,flexible:new Set}}),Object.keys(this.specialPurposes).forEach(e=>{this.bySpecialPurposeVendorMap[e]=new Set}),Object.keys(this.features).forEach(e=>{this.byFeatureVendorMap[e]=new Set}),Object.keys(this.specialFeatures).forEach(e=>{this.bySpecialFeatureVendorMap[e]=new Set}),Array.isArray(e)||(e=Object.keys(this.fullVendorList).map(e=>+e)),this.vendorIds=new Set(e),this.vendors_=e.reduce((e,t)=>{let s=this.vendors_[String(t)];return s&&void 0===s.deletedDate&&(s.purposes.forEach(e=>{let s=this.byPurposeVendorMap[String(e)];s.consent.add(t)}),s.specialPurposes.forEach(e=>{this.bySpecialPurposeVendorMap[String(e)].add(t)}),s.legIntPurposes.forEach(e=>{this.byPurposeVendorMap[String(e)].legInt.add(t)}),s.flexiblePurposes&&s.flexiblePurposes.forEach(e=>{this.byPurposeVendorMap[String(e)].flexible.add(t)}),s.features.forEach(e=>{this.byFeatureVendorMap[String(e)].add(t)}),s.specialFeatures.forEach(e=>{this.bySpecialFeatureVendorMap[String(e)].add(t)}),e[t]=s),e},{})}getFilteredVendors(e,t,s,n){let i=e.charAt(0).toUpperCase()+e.slice(1),r={};return("purpose"===e&&s?this["by"+i+"VendorMap"][String(t)][s]:this["by"+(n?"Special":"")+i+"VendorMap"][String(t)]).forEach(e=>{r[String(e)]=this.vendors[String(e)]}),r}getVendorsWithConsentPurpose(e){return this.getFilteredVendors("purpose",e,"consent")}getVendorsWithLegIntPurpose(e){return this.getFilteredVendors("purpose",e,"legInt")}getVendorsWithFlexiblePurpose(e){return this.getFilteredVendors("purpose",e,"flexible")}getVendorsWithSpecialPurpose(e){return this.getFilteredVendors("purpose",e,void 0,!0)}getVendorsWithFeature(e){return this.getFilteredVendors("feature",e)}getVendorsWithSpecialFeature(e){return this.getFilteredVendors("feature",e,void 0,!0)}get vendors(){return this.vendors_}narrowVendorsTo(e){this.mapVendors(e)}get isReady(){return this.isReady_}clone(){let e=new GVL(this.getJson());return this.lang_!==GVL.DEFAULT_LANGUAGE&&e.changeLanguage(this.lang_),e}static isInstanceOf(e){return"object"==typeof e&&"function"==typeof e.narrowVendorsTo}}class TCModel extends Cloneable{static consentLanguages=GVL.consentLanguages;isServiceSpecific_=!1;supportOOB_=!0;useNonStandardStacks_=!1;purposeOneTreatment_=!1;publisherCountryCode_="AA";version_=2;consentScreen_=0;policyVersion_=2;consentLanguage_="EN";cmpId_=0;cmpVersion_=0;vendorListVersion_=0;numCustomPurposes_=0;gvl_;created;lastUpdated;specialFeatureOptins=new Vector;purposeConsents=new Vector;purposeLegitimateInterests=new Vector;publisherConsents=new Vector;publisherLegitimateInterests=new Vector;publisherCustomConsents=new Vector;publisherCustomLegitimateInterests=new Vector;customPurposes;vendorConsents=new Vector;vendorLegitimateInterests=new Vector;vendorsDisclosed=new Vector;vendorsAllowed=new Vector;publisherRestrictions=new PurposeRestrictionVector;constructor(e){super(),e&&(this.gvl=e),this.updated()}set gvl(e){GVL.isInstanceOf(e)||(e=new GVL(e)),this.gvl_=e,this.publisherRestrictions.gvl=e}get gvl(){return this.gvl_}set cmpId(e){if(Number.isInteger(e=Number(e))&&e>1)this.cmpId_=e;else throw new TCModelError("cmpId",e)}get cmpId(){return this.cmpId_}set cmpVersion(e){if(Number.isInteger(e=Number(e))&&e>-1)this.cmpVersion_=e;else throw new TCModelError("cmpVersion",e)}get cmpVersion(){return this.cmpVersion_}set consentScreen(e){if(Number.isInteger(e=Number(e))&&e>-1)this.consentScreen_=e;else throw new TCModelError("consentScreen",e)}get consentScreen(){return this.consentScreen_}set consentLanguage(e){this.consentLanguage_=e}get consentLanguage(){return this.consentLanguage_}set publisherCountryCode(e){if(/^([A-z]){2}$/.test(e))this.publisherCountryCode_=e.toUpperCase();else throw new TCModelError("publisherCountryCode",e)}get publisherCountryCode(){return this.publisherCountryCode_}set vendorListVersion(e){if((e=Number(e)>>0)<0)throw new TCModelError("vendorListVersion",e);this.vendorListVersion_=e}get vendorListVersion(){return this.gvl?this.gvl.vendorListVersion:this.vendorListVersion_}set policyVersion(e){if(this.policyVersion_=parseInt(e,10),this.policyVersion_<0)throw new TCModelError("policyVersion",e)}get policyVersion(){return this.gvl?this.gvl.tcfPolicyVersion:this.policyVersion_}set version(e){this.version_=parseInt(e,10)}get version(){return this.version_}set isServiceSpecific(e){this.isServiceSpecific_=e}get isServiceSpecific(){return this.isServiceSpecific_}set useNonStandardStacks(e){this.useNonStandardStacks_=e}get useNonStandardStacks(){return this.useNonStandardStacks_}set supportOOB(e){this.supportOOB_=e}get supportOOB(){return this.supportOOB_}set purposeOneTreatment(e){this.purposeOneTreatment_=e}get purposeOneTreatment(){return this.purposeOneTreatment_}setAllVendorConsents(){this.vendorConsents.set(this.gvl.vendors)}unsetAllVendorConsents(){this.vendorConsents.empty()}setAllVendorsDisclosed(){this.vendorsDisclosed.set(this.gvl.vendors)}unsetAllVendorsDisclosed(){this.vendorsDisclosed.empty()}setAllVendorsAllowed(){this.vendorsAllowed.set(this.gvl.vendors)}unsetAllVendorsAllowed(){this.vendorsAllowed.empty()}setAllVendorLegitimateInterests(){this.vendorLegitimateInterests.set(this.gvl.vendors)}unsetAllVendorLegitimateInterests(){this.vendorLegitimateInterests.empty()}setAllPurposeConsents(){this.purposeConsents.set(this.gvl.purposes)}unsetAllPurposeConsents(){this.purposeConsents.empty()}setAllPurposeLegitimateInterests(){this.purposeLegitimateInterests.set(this.gvl.purposes)}unsetAllPurposeLegitimateInterests(){this.purposeLegitimateInterests.empty()}setAllSpecialFeatureOptins(){this.specialFeatureOptins.set(this.gvl.specialFeatures)}unsetAllSpecialFeatureOptins(){this.specialFeatureOptins.empty()}setAll(){this.setAllVendorConsents(),this.setAllPurposeLegitimateInterests(),this.setAllSpecialFeatureOptins(),this.setAllPurposeConsents(),this.setAllVendorLegitimateInterests()}unsetAll(){this.unsetAllVendorConsents(),this.unsetAllPurposeLegitimateInterests(),this.unsetAllSpecialFeatureOptins(),this.unsetAllPurposeConsents(),this.unsetAllVendorLegitimateInterests()}get numCustomPurposes(){let e=this.numCustomPurposes_;if("object"==typeof this.customPurposes){let t=Object.keys(this.customPurposes).sort((e,t)=>Number(e)-Number(t));e=parseInt(t.pop(),10)}return e}set numCustomPurposes(e){if(this.numCustomPurposes_=parseInt(e,10),this.numCustomPurposes_<0)throw new TCModelError("numCustomPurposes",e)}updated(){let e=new Date,t=new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()));this.created=t,this.lastUpdated=t}}class TCString{static encode(e,t){let s,n="";return e=SemanticPreEncoder.process(e,t),(s=Array.isArray(t?.segments)?t.segments:new SegmentSequence(e,t)[""+e.version]).forEach((t,i)=>{let r="";i<s.length-1&&(r="."),n+=SegmentEncoder.encode(e,t)+r}),n}static decode(e,t){let s=e.split("."),n=s.length;t||(t=new TCModel);for(let e=0;e<n;e++){let n=s[e],i=Base64Url.decode(n.charAt(0)),r=i.substr(0,BitLength.segmentType),o=SegmentIDs.ID_TO_KEY[IntEncoder.decode(r,BitLength.segmentType).toString()];SegmentEncoder.decode(n,t,o)}return t}}var RestrictionType,DeviceDisclosureStorageAccessType,Segment,VectorEncodingType,TCFCommand,CmpStatus,DisplayStatus,EventStatus,stubExports={},stub={get exports(){return stubExports},set exports(v){stubExports=v}};!function(e){function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}e.exports=function(){for(var e,s,n=[],i=window,r=i;r;){try{if(r.frames.__tcfapiLocator){e=r;break}}catch(e){}if(r===i.top)break;r=r.parent}e||(!function e(){var t=i.document,s=!!i.frames.__tcfapiLocator;if(!s){if(t.body){var n=t.createElement("iframe");n.style.cssText="display:none",n.name="__tcfapiLocator",t.body.appendChild(n)}else setTimeout(e,5)}return!s}(),i.__tcfapi=function(){for(var e=arguments.length,t=Array(e),i=0;i<e;i++)t[i]=arguments[i];if(!t.length)return n;"setGdprApplies"===t[0]?t.length>3&&2===parseInt(t[1],10)&&"boolean"==typeof t[3]&&(s=t[3],"function"==typeof t[2]&&t[2]("set",!0)):"ping"===t[0]?"function"==typeof t[2]&&t[2]({gdprApplies:s,cmpLoaded:!1,cmpStatus:"stub"}):n.push(t)},i.addEventListener("message",function(e){var s="string"==typeof e.data,n={};if(s)try{n=JSON.parse(e.data)}catch(e){}else n=e.data;var i="object"===t(n)?n.__tcfapiCall:null;i&&window.__tcfapi(i.command,i.version,function(t,n){var r={__tcfapiReturn:{returnValue:t,success:n,callId:i.callId}};e&&e.source&&e.source.postMessage&&e.source.postMessage(s?JSON.stringify(r):r,"*")},i.parameter)},!1))}}(stub);var cmpstub=stubExports;!function(e){e.PING="ping",e.GET_TC_DATA="getTCData",e.GET_IN_APP_TC_DATA="getInAppTCData",e.GET_VENDOR_LIST="getVendorList",e.ADD_EVENT_LISTENER="addEventListener",e.REMOVE_EVENT_LISTENER="removeEventListener"}(TCFCommand||(TCFCommand={})),function(e){e.STUB="stub",e.LOADING="loading",e.LOADED="loaded",e.ERROR="error"}(CmpStatus||(CmpStatus={})),function(e){e.VISIBLE="visible",e.HIDDEN="hidden",e.DISABLED="disabled"}(DisplayStatus||(DisplayStatus={})),function(e){e.TC_LOADED="tcloaded",e.CMP_UI_SHOWN="cmpuishown",e.USER_ACTION_COMPLETE="useractioncomplete"}(EventStatus||(EventStatus={}));class Command{listenerId;callback;next;param;success=!0;constructor(e,t,s,n){Object.assign(this,{callback:e,listenerId:s,param:t,next:n});try{this.respond()}catch(e){this.invokeCallback(null)}}invokeCallback(e){let t=null!==e;"function"==typeof this.next?this.callback(this.next,e,t):this.callback(e,t)}}class GetTCDataCommand extends Command{respond(){this.throwIfParamInvalid(),this.invokeCallback(new TCData(this.param,this.listenerId))}throwIfParamInvalid(){if(void 0!==this.param&&(!Array.isArray(this.param)||!this.param.every(Number.isInteger)))throw Error("Invalid Parameter")}}class EventListenerQueue{eventQueue=new Map;queueNumber=0;add(e){return this.eventQueue.set(this.queueNumber,e),this.queueNumber++}remove(e){return this.eventQueue.delete(e)}exec(){this.eventQueue.forEach((e,t)=>{new GetTCDataCommand(e.callback,e.param,t,e.next)})}clear(){this.queueNumber=0,this.eventQueue.clear()}get size(){return this.eventQueue.size}}class CmpApiModel{static apiVersion="2";static tcfPolicyVersion;static eventQueue=new EventListenerQueue;static cmpStatus=CmpStatus.LOADING;static disabled=!1;static displayStatus=DisplayStatus.HIDDEN;static cmpId;static cmpVersion;static eventStatus;static gdprApplies;static tcModel;static tcString;static reset(){delete this.cmpId,delete this.cmpVersion,delete this.eventStatus,delete this.gdprApplies,delete this.tcModel,delete this.tcString,delete this.tcfPolicyVersion,this.cmpStatus=CmpStatus.LOADING,this.disabled=!1,this.displayStatus=DisplayStatus.HIDDEN,this.eventQueue.clear()}}class Response{cmpId=CmpApiModel.cmpId;cmpVersion=CmpApiModel.cmpVersion;gdprApplies=CmpApiModel.gdprApplies;tcfPolicyVersion=CmpApiModel.tcfPolicyVersion}class Disabled extends Response{cmpStatus=CmpStatus.ERROR}class TCData extends Response{tcString;listenerId;eventStatus;cmpStatus;isServiceSpecific;useNonStandardStacks;publisherCC;purposeOneTreatment;outOfBand;purpose;vendor;specialFeatureOptins;publisher;constructor(e,t){if(super(),this.eventStatus=CmpApiModel.eventStatus,this.cmpStatus=CmpApiModel.cmpStatus,this.listenerId=t,CmpApiModel.gdprApplies){let t=CmpApiModel.tcModel;this.tcString=CmpApiModel.tcString,this.isServiceSpecific=t.isServiceSpecific,this.useNonStandardStacks=t.useNonStandardStacks,this.purposeOneTreatment=t.purposeOneTreatment,this.publisherCC=t.publisherCountryCode,this.outOfBand={allowedVendors:this.createVectorField(t.vendorsAllowed,e),disclosedVendors:this.createVectorField(t.vendorsDisclosed,e)},this.purpose={consents:this.createVectorField(t.purposeConsents),legitimateInterests:this.createVectorField(t.purposeLegitimateInterests)},this.vendor={consents:this.createVectorField(t.vendorConsents,e),legitimateInterests:this.createVectorField(t.vendorLegitimateInterests,e)},this.specialFeatureOptins=this.createVectorField(t.specialFeatureOptins),this.publisher={consents:this.createVectorField(t.publisherConsents),legitimateInterests:this.createVectorField(t.publisherLegitimateInterests),customPurpose:{consents:this.createVectorField(t.publisherCustomConsents),legitimateInterests:this.createVectorField(t.publisherCustomLegitimateInterests)},restrictions:this.createRestrictions(t.publisherRestrictions)}}}createRestrictions(e){let t={};if(e.numRestrictions>0){let s=e.getMaxVendorId();for(let n=1;n<=s;n++){let s=n.toString();e.getRestrictions(n).forEach(e=>{let n=e.purposeId.toString();t[n]||(t[n]={}),t[n][s]=e.restrictionType})}}return t}createVectorField(e,t){return t?t.reduce((t,s)=>(t[String(s)]=e.has(Number(s)),t),{}):[...e].reduce((e,t)=>(e[t[0].toString(10)]=t[1],e),{})}}class InAppTCData extends TCData{constructor(e){super(e),delete this.outOfBand}createVectorField(e){return[...e].reduce((e,t)=>e+=t[1]?"1":"0","")}createRestrictions(e){let t={};if(e.numRestrictions>0){let s=e.getMaxVendorId();e.getRestrictions().forEach(e=>{t[e.purposeId.toString()]="_".repeat(s)});for(let n=0;n<s;n++){let s=n+1;e.getRestrictions(s).forEach(e=>{let s=e.restrictionType.toString(),i=e.purposeId.toString(),r=t[i].substr(0,n),o=t[i].substr(n+1);t[i]=r+s+o})}}return t}}class Ping extends Response{cmpLoaded=!0;cmpStatus=CmpApiModel.cmpStatus;displayStatus=CmpApiModel.displayStatus;apiVersion=String(CmpApiModel.apiVersion);gvlVersion;constructor(){super(),CmpApiModel.tcModel&&CmpApiModel.tcModel.vendorListVersion&&(this.gvlVersion=+CmpApiModel.tcModel.vendorListVersion)}}class PingCommand extends Command{respond(){this.invokeCallback(new Ping)}}class GetInAppTCDataCommand extends GetTCDataCommand{respond(){this.throwIfParamInvalid(),this.invokeCallback(new InAppTCData(this.param))}}class GetVendorListCommand extends Command{respond(){let e;let t=CmpApiModel.tcModel,s=t.vendorListVersion;void 0===this.param&&(this.param=s),(e=this.param===s&&t.gvl?t.gvl:new GVL(this.param)).readyPromise.then(()=>{this.invokeCallback(e.getJson())})}}class AddEventListenerCommand extends GetTCDataCommand{respond(){this.listenerId=CmpApiModel.eventQueue.add({callback:this.callback,param:this.param,next:this.next}),super.respond()}}class RemoveEventListenerCommand extends Command{respond(){this.invokeCallback(CmpApiModel.eventQueue.remove(this.param))}}class CommandMap{static [TCFCommand.PING]=PingCommand;static [TCFCommand.GET_TC_DATA]=GetTCDataCommand;static [TCFCommand.GET_IN_APP_TC_DATA]=GetInAppTCDataCommand;static [TCFCommand.GET_VENDOR_LIST]=GetVendorListCommand;static [TCFCommand.ADD_EVENT_LISTENER]=AddEventListenerCommand;static [TCFCommand.REMOVE_EVENT_LISTENER]=RemoveEventListenerCommand}class SupportedVersions{static set_=new Set([0,2,void 0,null]);static has(e){return"string"==typeof e&&(e=Number(e)),this.set_.has(e)}}let API_KEY="__tcfapi";class CallResponder{callQueue;customCommands;constructor(e){if(e){let t=TCFCommand.ADD_EVENT_LISTENER;if(e?.[t])throw Error(`Built-In Custom Commmand for ${t} not allowed: Use ${TCFCommand.GET_TC_DATA} instead`);if(t=TCFCommand.REMOVE_EVENT_LISTENER,e?.[t])throw Error(`Built-In Custom Commmand for ${t} not allowed`);e?.[TCFCommand.GET_TC_DATA]&&(e[TCFCommand.ADD_EVENT_LISTENER]=e[TCFCommand.GET_TC_DATA],e[TCFCommand.REMOVE_EVENT_LISTENER]=e[TCFCommand.GET_TC_DATA]),this.customCommands=e}try{this.callQueue=window[API_KEY]()||[]}catch(e){this.callQueue=[]}finally{window[API_KEY]=this.apiCall.bind(this),this.purgeQueuedCalls()}}apiCall(e,t,s){for(var n=arguments.length,i=Array(n>3?n-3:0),r=3;r<n;r++)i[r-3]=arguments[r];if("string"!=typeof e)s(null,!1);else if(SupportedVersions.has(t)){if("function"!=typeof s)throw Error("invalid callback function");CmpApiModel.disabled?s(new Disabled,!1):this.isCustomCommand(e)||this.isBuiltInCommand(e)?this.isCustomCommand(e)&&!this.isBuiltInCommand(e)?this.customCommands[e](s,...i):e===TCFCommand.PING?this.isCustomCommand(e)?new CommandMap[e](this.customCommands[e],i[0],null,s):new CommandMap[e](s,i[0]):void 0===CmpApiModel.tcModel?this.callQueue.push([e,t,s,...i]):this.isCustomCommand(e)&&this.isBuiltInCommand(e)?new CommandMap[e](this.customCommands[e],i[0],null,s):new CommandMap[e](s,i[0]):s(null,!1)}else s(null,!1)}purgeQueuedCalls(){let e=this.callQueue;this.callQueue=[],e.forEach(e=>{window[API_KEY](...e)})}isCustomCommand(e){return this.customCommands&&"function"==typeof this.customCommands[e]}isBuiltInCommand(e){return void 0!==CommandMap[e]}}class CmpApi{callResponder;isServiceSpecific;numUpdates=0;constructor(e,t,s=!1,n){this.throwIfInvalidInt(e,"cmpId",2),this.throwIfInvalidInt(t,"cmpVersion",0),CmpApiModel.cmpId=e,CmpApiModel.cmpVersion=t,CmpApiModel.tcfPolicyVersion=2,this.isServiceSpecific=!!s,this.callResponder=new CallResponder(n)}throwIfInvalidInt(e,t,s){if(!("number"==typeof e&&Number.isInteger(e)&&e>=s))throw Error(`Invalid ${t}: ${e}`)}update(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(CmpApiModel.disabled)throw Error("CmpApi Disabled");CmpApiModel.cmpStatus=CmpStatus.LOADED,t?(CmpApiModel.displayStatus=DisplayStatus.VISIBLE,CmpApiModel.eventStatus=EventStatus.CMP_UI_SHOWN):void 0===CmpApiModel.tcModel?(CmpApiModel.displayStatus=DisplayStatus.DISABLED,CmpApiModel.eventStatus=EventStatus.TC_LOADED):(CmpApiModel.displayStatus=DisplayStatus.HIDDEN,CmpApiModel.eventStatus=EventStatus.USER_ACTION_COMPLETE),CmpApiModel.gdprApplies=null!==e,CmpApiModel.gdprApplies?(""===e?(CmpApiModel.tcModel=new TCModel,CmpApiModel.tcModel.cmpId=CmpApiModel.cmpId,CmpApiModel.tcModel.cmpVersion=CmpApiModel.cmpVersion):CmpApiModel.tcModel=TCString.decode(e),CmpApiModel.tcModel.isServiceSpecific=this.isServiceSpecific,CmpApiModel.tcfPolicyVersion=Number(CmpApiModel.tcModel.policyVersion),CmpApiModel.tcString=e):CmpApiModel.tcModel=null,0===this.numUpdates?this.callResponder.purgeQueuedCalls():CmpApiModel.eventQueue.exec(),this.numUpdates++}disable(){CmpApiModel.disabled=!0,CmpApiModel.cmpStatus=CmpStatus.ERROR}}let search="nv2u9",notfound="nv348",__default$7={search:"nv2u9",notfound:"nv348"},vendor$1="t26u",vendorExpanded="t26u t22ky",line$1="t2128",name$1="t2f4",toggle$3="t21qn",descriptions$1="t21qi",point$1="t21pl",feature="t2ob",section="t2y6",cookie="t21cy",details$1="t22q9",stroke$1="t2zi",policy="t2p2",__default$6={vendor:"t26u",vendorExpanded:"t26u t22ky",line:"t2128",name:"t2f4",toggle:"t21qn",descriptions:"t21qi",point:"t21pl",feature:"t2ob",section:"t2y6",cookie:"t21cy",details:"t22q9",stroke:"t2zi",policy:"t2p2"},toggle$2="Beh28h",button$2="Beh29q",on="Beh1k3",off="Behyf",__default$5={toggle:"Beh28h",button:"Beh29q",on:"Beh1k3",off:"Behyf"},onClick=e=>e.stopPropagation();function Toggle(t){let{checked:s,onChange:n}=t;return e("div",{className:__default$5.toggle,onClick,children:[e("label",{className:__default$5.on,children:[e("input",{type:"radio",checked:"on"===s,value:"on",onChange:n}),e("span",{className:__default$5.button,children:"On"})]}),e("label",{className:__default$5.off,children:[e("input",{type:"radio",checked:"off"===s,value:"off",onChange:n}),e("span",{className:__default$5.button,children:"Off"})]})]})}function VendorDetails(e){let{vendor:t,gvl:n,show:i}=e,r="consent"===i?t.purposes:t.legIntPurposes,o=t.features.length>0,a=t.specialPurposes.length>0,l=t.specialFeatures.length>0,c=Math.ceil((t.cookieMaxAgeSeconds||0)/86400);return s("div",{className:__default$6.details},s("a",{href:t.policyUrl,className:__default$6.policy,title:"Privacy Policy",target:"_blank"},t.name),s("div",{className:__default$6.section},"consent"===i?"Consent Purposes":"Legitimate Interest Purposes"),r.map(e=>s("div",{className:__default$6.feature},n.purposes[e].name)),o&&s("div",{className:__default$6.section},"Features"),o&&t.features.map(e=>s("div",{className:__default$6.feature},n.features[e].name)),a&&s("div",{className:__default$6.section},"Special Purposes"),a&&t.specialPurposes.map(e=>s("div",{className:__default$6.feature},n.specialPurposes[e].name)),l&&s("div",{className:__default$6.section},"Special Features"),l&&t.specialFeatures.map(e=>s("div",{className:__default$6.feature},n.specialFeatures[e].name)),s("div",{className:__default$6.cookie},`Uses cookies: ${t.usesCookies?"Yes":"No"}`),t.usesCookies&&s("div",{className:__default$6.cookie},`Cookie refresh: ${t.cookieRefresh?"Yes":"No"}`),t.usesCookies&&s("div",{className:__default$6.cookie},`Cookie max age: ${c} ${1===c?"day":"days"}`),s("div",{className:__default$6.cookie},`Uses Non-Cookie Access: ${t.usesNonCookieAccess?"Yes":"No"}`))}function Vendor(n){let{gvl:i,vendor:o,consents:a,show:l}=n,c=a.has(o.id),[d,u]=t(c?"on":"off"),[p,h]=t(!1),m=e=>{let t=e.target.value;u(t),"on"===t?a.set(o.id):a.unset(o.id),e.stopPropagation()},g=()=>{h(!p)};return e("div",{className:p?__default$6.vendorExpanded:__default$6.vendor,children:[e("div",{className:__default$6.line,onClick:g,children:[e(r,{up:p,styles:__default$6}),e("div",{className:__default$6.name,children:o.name}),e("div",{className:__default$6.toggle,children:e(Toggle,{checked:d,onChange:m})})]}),p&&s(VendorDetails,{vendor:o,gvl:i,show:l})]})}let toggle$1="Bt45n",button$1="Bt4vb",__default$4={toggle:"Bt45n",button:"Bt4vb"};function ConsentToggle(t){let{show:s,setShow:n}=t,i=e=>{let t=e.target.value;n(t),e.stopPropagation()};return e("div",{className:__default$4.toggle,children:[e("label",{children:[e("input",{type:"radio",checked:"consent"===s,value:"consent",onChange:i}),e("span",{className:__default$4.button,children:"User Consent"})]}),e("label",{children:[e("input",{type:"radio",checked:"interest"===s,value:"interest",onChange:i}),e("span",{className:__default$4.button,children:"Legitimate Interest"})]})]})}function Vendors(i){let{gvl:r,tcModel:o}=i,[a,l]=t("consent"),[c,d]=t(""),u=n(()=>Object.values(r.vendors).sort((e,t)=>e.name.localeCompare(t.name)),[r.vendors]),p=c.toLowerCase(),h=u.filter("consent"===a?e=>e.purposes.length>0||e.specialPurposes.length>0||e.specialFeatures.length>0:e=>e.legIntPurposes.length>0).filter(e=>-1!==e.name.toLowerCase().indexOf(p)),m="consent"===a?o.vendorConsents:o.vendorLegitimateInterests,g=e=>d(e.target.value);return s("div",{className:__default$7.vendors},s(ConsentToggle,{show:a,setShow:l}),s("input",{className:__default$7.search,value:c,onChange:g,placeholder:"Search Vendors..."}),h.map(t=>e(Vendor,{gvl:r,vendor:t,consents:m,show:a},a+t.id)),0===h.length&&s("p",{className:__default$7.notfound},"No results"))}let title$1="u21rn",help="u254",__default$3={title:"u21rn",help:"u254"},purpose="Bnz2i8",purposeExpanded="Bnz2i8 Bnz2qy",line="Bnzr2",name="Bnz2mj",toggle="Bnz2v6",descriptions="Bnzg6",point="Bnzui",bullet="Bnzhx",details="Bnz4o",stroke="Bnz148",vendor="Bnzpc",more="Bnzxr",__default$2={purpose:"Bnz2i8",purposeExpanded:"Bnz2i8 Bnz2qy",line:"Bnzr2",name:"Bnz2mj",toggle:"Bnz2v6",descriptions:"Bnzg6",point:"Bnzui",bullet:"Bnzhx",details:"Bnz4o",stroke:"Bnz148",vendor:"Bnzpc",more:"Bnzxr"};function Purpose(e){let{getVendors:i,purpose:o,consents:a}=e,l=o.description.split("\n"),c=o.descriptionLegal.split("\n"),d=a&&a.has(o.id),[u,p]=t(d?"on":"off"),[h,m]=t(!1),[g,f]=t(!1),C=e=>{let t=e.target.value;p(t),"on"===t?a.set(o.id):a.unset(o.id),e.stopPropagation()},E=()=>{m(!h)},_=()=>{f(!g)},S=n(()=>{if(!h)return null;let e=Object.values(i(o.id)).sort((e,t)=>e.name.localeCompare(t.name));return g?e:e.slice(0,3)},[h,g,i]);return s("div",{className:h?__default$2.purposeExpanded:__default$2.purpose},s("div",{className:__default$2.line,onClick:E},s(r,{up:h,styles:__default$2}),s("div",{className:__default$2.name},o.name),a&&s("div",{className:__default$2.toggle},s(Toggle,{checked:u,onChange:C}))),h&&s("div",{className:__default$2.details},l.map(e=>s("div",{className:__default$2.description},e)),c.map(e=>s("div",{className:0===e.indexOf("*")?__default$2.bullet:__default$2.point},e.replace(/^\*/,"").trim())),S.map(e=>s("a",{href:e.policyUrl,className:__default$2.vendor,target:"_blank"},e.name)),S.length>0&&s("span",{className:__default$2.more,onClick:_},g?"View\xa0\xa0less":"View\xa0all")))}function Purposes(n){let{gvl:i,tcModel:r}=n,[o,a]=t("consent"),l="consent"===o?i.getVendorsWithConsentPurpose.bind(i):i.getVendorsWithLegIntPurpose.bind(i),c="consent"===o?r.purposeConsents:r.purposeLegitimateInterests;return s("div",{className:__default$3.purposes},s(ConsentToggle,{show:o,setShow:a}),s("p",{className:__default$3.title},"Purposes"),s("p",{className:__default$3.help},"consent"===o?"You give an affirmative action to indicate that we can use your data for this purpose.":"We have a need to use your data for this processing purpose that is required for us to deliver services to you."),Object.values(i.purposes).filter(e=>"consent"===o||1!==e.id).map(t=>e(Purpose,{getVendors:l,purpose:t,consents:c,show:o},o+t.id)),s("p",{className:__default$3.title},"Special Purposes"),s("p",{className:__default$3.help},"We have a need to use your data for this processing purpose that is required for us to deliver services to you."),Object.values(i.specialPurposes).map(t=>e(Purpose,{getVendors:i.getVendorsWithSpecialPurpose.bind(i),purpose:t},t.name)))}let highlight="B7n1dc",text$1="B7n31f",__default$1={highlight:"B7n1dc",text:"B7n31f"};function Features(t){let{gvl:n,tcModel:i}=t;return s("div",{className:__default$1.features},s("p",{className:__default$1.text},s("strong",{className:__default$1.highlight},"Features")," are a use of the data that you have already agreed to share with us."),Object.values(n.features).map(t=>e(Purpose,{getVendors:n.getVendorsWithFeature.bind(n),purpose:t},t.name)),s("p",{className:__default$1.text},s("strong",{className:__default$1.highlight},"Special Features")," are processing purposes that require your explicit consent."),Object.values(n.specialFeatures).map(t=>e(Purpose,{getVendors:n.getVendorsWithSpecialFeature.bind(n),purpose:t,consents:i.specialFeatureOptins},t.name)))}function Details(e){let{state:n,options:i,closeView:r,openSummaryView:a}=e,l=()=>{r(),n.acceptAll(2)},c=()=>{r(),n.rejectAll(2)},d=()=>{r(),n.confirmChoice(2)},u=()=>{i?.cancel==="summary"?a():r()},[p,h]=t(i?.section||"purposes"),m=()=>h("purposes"),g=()=>h("features"),f=()=>h("vendors"),C=n.tcModel.gvl;return s("section",{className:o.settings},s("div",{className:o.panel},s("div",{className:o.head},s("div",{className:o.title},"Privacy settings"),s("p",null,"Please manage your cookie choices by switching the consent toggles on or off under the Purposes listed below. You can also choose to click:"),s("div",{className:o.fastActions},s("button",{id:"accept",className:o.fast,onClick:c},"Reject all"),s("button",{id:"refuse",className:o.fast,onClick:l},"Accept all")),s("button",{className:"purposes"===p?o.switchActive:o.switch,onClick:m},"Purposes"),s("button",{className:"features"===p?o.switchActive:o.switch,onClick:g},"Features"),s("button",{className:"vendors"===p?o.switchActive:o.switch,onClick:f},"Vendors")),s("div",{className:o.body},"purposes"===p&&s(Purposes,{gvl:C,tcModel:n.tcModel}),"features"===p&&s(Features,{gvl:C,tcModel:n.tcModel}),"vendors"===p&&s(Vendors,{gvl:C,tcModel:n.tcModel})),s("div",{className:o.actions},s("p",null,"You can change the above settings for this browser at any time by clicking the privacy settings link in the footer of the page."),s("button",{id:"save",className:o.button,onClick:d},"Save & close"),s("button",{id:"cancel",className:o.buttonGray,onClick:u},"Cancel"))))}let consent="Cqw1bs",panel="Cqw1d2",align="Cqw11o",row="Cqw76",column="Cqw1q5",title="Cqw1hm",caption="Cqw1id",note="Cqw1wb",columnSmallScreen="Cqw1q5 Cqwii",text="Cqw1if",actions="Cqwug",button="Cqwdk",buttonGray="Cqwdk Cqw3e",buttonInline="Cqw1yo",__default={consent:"Cqw1bs",panel:"Cqw1d2",align:"Cqw11o",row:"Cqw76",column:"Cqw1q5",title:"Cqw1hm",caption:"Cqw1id",note:"Cqw1wb",columnSmallScreen:"Cqw1q5 Cqwii",text:"Cqw1if",actions:"Cqwug",button:"Cqwdk",buttonGray:"Cqwdk Cqw3e",buttonInline:"Cqw1yo"};function Summary(e){let{state:t,openDetailsView:n,closeView:i}=e,r=e=>{e.preventDefault(),i(),t.acceptAll(1)},o=e=>{e.preventDefault(),n("purposes")},l=e=>{e.preventDefault(),n("vendors")};return s("section",{className:__default.consent},s("div",{className:__default.panel},s("div",{className:__default.align},s("div",{className:__default.title},"Its your choice"),s("div",{className:__default.summary},s("div",{className:__default.row},s("div",{className:__default.column},s("p",null,"When we\xa0make the Songsterr available to\xa0you online, we\xa0use cookies and similar technologies to\xa0help\xa0us to\xa0do\xa0this. Some are necessary to\xa0help our website work properly and can't be\xa0switched off, and some are optional but support the Songsterr and your experience in\xa0other ways.")),s("div",{className:__default.column},s("p",null,"We\xa0and ",s("button",{className:__default.buttonInline,onClick:l},"our partners")," store and access information on a\xa0device, such as\xa0cookies, and process personal data, such as\xa0unique identifiers, page visits, IP address, and standard information sent by a\xa0device to\xa0provide, analyse, and improve our services. This includes personalising content or\xa0advertising for you.")),s("div",{className:__default.column},s("p",{className:__default.note},"We\xa0use cookies and similar technologies for the following purposes:"),s("ul",null,s("li",null,"Store and/or access information on\xa0a\xa0device"),s("li",null,"Personalised ads and content, ad\xa0and content measurement, audience insights and product development"))),s("div",{className:__default.column},s("p",null,"You can find out more in\xa0our ",s(a,{href:"/a/wa/privacy"},"privacy\xa0policy")," and ",s(a,{href:"/a/wa/terms"},"terms of\xa0service")," and manage the choices available to\xa0you at\xa0any time by\xa0going to 'Privacy settings' at\xa0the bottom of\xa0any page."))),s("div",{className:__default.cta},s("p",{className:__default.text},s("span",{className:__default.caption},"Are you happy to accept cookies? "),"To\xa0manage your cookie choices now, including how to\xa0opt out where our partners rely on\xa0legitimate interests to\xa0use your information, ",s("span",{className:__default.note},"click on\xa0Manage\xa0my\xa0cookies."))))),s("div",{className:__default.actions},s("div",{className:__default.align},s("button",{id:"accept",className:__default.button,onClick:r},"Accept cookies"),s("button",{id:"refuse",className:__default.buttonGray,onClick:o},"Manage my cookies")))))}cmpstub(),GVL.baseUrl="/vendor-list.consensu.org/v2";let CMP_ID=384,CMP_VERSION=1,getCmpApi=()=>(cmpApi||(cmpApi=new CmpApi(384,1,!0)),cmpApi);class ConsentState{constructor(e,t){if(this.actions=t,e)try{this.tcModel=TCString.decode(e)}catch(t){console.error(t),e=void 0}e||(this.tcModel=new TCModel),this.hasConsent=!!e,getCmpApi().update(e||"",!e),this.gvl=new GVL,this.tcModel.gvl=this.gvl,this.tcModel.cmpId=384,this.tcModel.cmpVersion=1,this.tcModel.isServiceSpecific=!0,this.hasConsent&&this.ready().then(()=>{this.tcModel.policyVersion!==this.gvl.tcfPolicyVersion&&this.actions.openSummaryView()})}confirmChoice(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.tcModel.consentScreen=e,this.hasConsent=!0;let t=TCString.encode(this.tcModel);d("euconsent-v2",t),getCmpApi().update(t,!1)}async acceptAll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;await this.ready(),this.tcModel.setAll(),this.confirmChoice(e)}async rejectAll(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;await this.ready(),this.tcModel.unsetAll(),this.confirmChoice(e)}ready(){return this.tcModel.gvl.readyPromise}shouldShow(){return!this.hasConsent}}function ConsentManager(){let{dispatch:e,consent:n,isTestMode:r}=l("consent","isTestMode"),[o,a]=t(null);if(r)return null;let d=()=>{e("consent/view",{suite:"tcf",view:"summary",options:null})},u=async t=>{await o.ready(),e("consent/view",{suite:"tcf",view:"details",options:{section:t,cancel:"summary"}})},p=()=>{e("consent/view",{suite:null,view:null,options:null})};if(i(()=>{try{let e=c("euconsent-v2"),t=new ConsentState(e,{openSummaryView:d,openDetailsView:u,closeView:p});a(t),t.shouldShow()&&d()}catch(e){console.error(e)}},[]),!n.suite||!n.view||!o)return null;let h={state:o,options:n.options,openSummaryView:d,openDetailsView:u,closeView:p};return"summary"===n.view?s(Summary,h):"details"===n.view?s(Details,h):void 0}export{ConsentState,ConsentManager as default};
